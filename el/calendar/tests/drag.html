<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>u2-calendar â€” drag test</title>

  <link rel="stylesheet" href="../../../css/classless/full.css">
  <link rel="stylesheet" href="../../../css/classless/simple.css">

  <link rel="stylesheet" href="../calendar.css">
  <script src="../calendar.js" type="module" async></script>
  <script src="../drag.js" type="module" async></script>
</head>
<body>
  <section>
    <h2>Drag & Drop Test</h2>
    <p>Drag events to other days. Times and durations should be preserved where applicable.</p>

    <u2-calendar view="month" id="calendar" date="2025-10-01" locale="de-DE">
      <u2-calendaritem start="2025-09-30" draggable="true">Prev-month Spill</u2-calendaritem>
    </u2-calendar>

    <h3>Instructions</h3>
    <ul>
      <li>Click and drag an event to another visible day cell.</li>
      <li>If the event had a time (contains 'T'), the time-of-day is preserved.</li>
      <li>If the event had an end, the duration is preserved.</li>
      <li>The ghost preview is rendered on top of the page so it stays visible even if the calendar has overflow:hidden.</li>
    </ul>

    <h3>Debug</h3>
    <pre id="debug"></pre>

    <script>
      // simple debug output showing attributes after move
      const debug = document.getElementById('debug');
      const observer = new MutationObserver(() => {
        const items = Array.from(document.querySelectorAll('u2-calendaritem'));
        debug.textContent = items.map(i => `${i.textContent.trim()} -> start=${i.getAttribute('start')} end=${i.getAttribute('end') || '(none)'}`).join('\n');
      });
      observer.observe(document.body, { attributes: true, subtree: true, attributeFilter: ['start','end'] });

      // initial dump
      setTimeout(() => {
        const event = new Event('mutation');
        observer.takeRecords();
        observer.disconnect();
        observer.observe(document.body, { attributes: true, subtree: true, attributeFilter: ['start','end'] });
      }, 200);
    </script>
  </section>
</body>
</html>
