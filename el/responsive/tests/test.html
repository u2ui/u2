<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset=utf-8>
    <meta name=viewport content="width=device-width">
    <title>test</title>

    <script src="../../../u2/tests/test-init.js" type=module async></script>
    <script src="../../../u2/auto.js" type=module async></script>
    <link rel=stylesheet href="../../../css/classless/simple.css">

    <link href="../responsive.css" rel=stylesheet>
    <script src="../responsive.js" type=module async></script>

<body>

    <h2>Attributes</h2>
    <form id="attrForm">
        <u2-fields>
            <input name=mutation type=checkbox name="mutation"></u2-input>
            <input name=strategies value="hide-optional1 hide-optional2 break">
        </u2-fields>
        <script>
        attrForm.oninput = e=>{
            for (const inp of attrForm.elements) {
                if (inp.type === 'checkbox') {
                    if (inp.checked) demoEl.setAttribute(inp.name, '');
                    else demoEl.removeAttribute(inp.name);
                } else {
                    demoEl.setAttribute(inp.name, inp.value);
                }
            }
        }
        </script>
    </form>


<u2-code trim editable>
    <style>
        u2-responsive {
            &:state(hide-optional1) .optional1 {
                display: none;
            }
            &:state(hide-optional2) .optional2 {
                display: none;
            }
            &:state(break) td {

                display: block;
                width: 100%;
            }
            &:state(break) tr {
                display: block;
                margin-bottom: 1rem;
                td { margin-bottom:-1px; }
            }
        }
        td {
            border: 1px solid #000;
            padding: .8rem;
            white-space:nowrap;
        }
    </style>
</u2-code>

<section style="resize:both; overflow:auto; padding:2rem; border:1px solid black">
    <u2-responsive strategies="hide-optional1 hide-optional2 break" id="demoEl">
        <table>
            <tr>
                <td contenteditable>Website Update (editable)
                <td>In Progress
                <td class="optional1">High
                <td class="optional2">2025-11-30
                <td>Tobias
                <td>Adjust layout
            <tr>
                <td>Server Maintenance
                <td>Completed
                <td class="optional1">Medium
                <td class="optional2">2025-11-20
                <td>Anna
                <td>Backup created
            <tr>
                <td>Content Creation
                <td>Pending
                <td class="optional1">Low
                <td class="optional2">2025-12-05
                <td>Mark
                <td contenteditable>Topic planning needed (editable)
        </table>
    </u2-responsive>
</section>

<div style="margin-top: 2rem; padding: 1rem; background: #f0f0f0; border-radius: 4px;">
    <strong>Event Log: <button id=clearLog>clear</button></strong>
    <div id="log" style="font-family: monospace; font-size: 0.7rem; overflow:auto; max-height:20rem"></div>
</div>


<script>

// Event Listener Demo
const responsive = document.querySelector('u2-responsive');

setTimeout(()=>{
    responsive.debug();
},1000);

const log = document.getElementById('log');
clearLog.onclick = ()=>{log.innerHTML = ''};

responsive.addEventListener('u2-responsive-strategy-add', (e) => {
    const entry = document.createElement('div');
    entry.style.color = 'green';
    entry.textContent = `✓ Strategy added: ${e.detail.strategy}`;
    log.prepend(entry);

    // Example: Prevent a specific strategy
    // if (e.detail.strategy === 'break') {
    //     e.preventDefault();
    // }
});

responsive.addEventListener('u2-responsive-strategy-remove', (e) => {
    const entry = document.createElement('div');
    entry.style.color = 'red';
    entry.textContent = `✗ Strategy removed: ${e.detail.strategy}`;
    log.prepend(entry);
});


</script>